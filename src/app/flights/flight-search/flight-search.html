<section class="hero">
  <div class="hero-card">
    <h1>Find your next flight</h1>
    <p class="sub">Search by airline or by date</p>

    <form class="search" [formGroup]="form" (ngSubmit)="search()">

      <div class="row">
        <div class="field">
          <label>From</label>
          <input formControlName="fromPlace" placeholder="Bangalore" />
        </div>

        <div class="field">
          <label>To</label>
          <input formControlName="toPlace" placeholder="Delhi" />
        </div>
      </div>

      <div class="row">
        <div class="field">
          <label>Search By</label>
          <select formControlName="searchType">
            <option value="AIRLINE">Airline</option>
            <option value="DATE">Date</option>
          </select>
        </div>

        <div class="field" *ngIf="form.value.searchType === 'AIRLINE'">
          <label>Airline</label>
          <input formControlName="airline" placeholder="IndiGo / Air India" />
        </div>

        <div class="field" *ngIf="form.value.searchType === 'DATE'">
          <label>Date</label>
          <input type="date" formControlName="date" [min]="minDate"/>
        </div>
      </div>

      <button class="btn" type="submit" [disabled]="loading">
        {{ loading ? 'Searching...' : 'Search Flights' }}
      </button>

      <div class="err" *ngIf="error">{{ error }}</div>
    </form>
  </div>
</section>

<section class="results" *ngIf="searched && flights.length > 0">
  <div class="flight" *ngFor="let f of flights">
    <div class="flight-left">
      <div class="airline">{{ f.airline }}</div>
      <div class="route">
        <span class="pill">{{ f.fromPlace }}</span>
        <span class="arrow">→</span>
        <span class="pill">{{ f.toPlace }}</span>
      </div>
      <div class="times">
        <div>
          <div class="k">Departure</div>
          <div class="v">{{ f.departureTime | date:'short' }}</div>
        </div>
        <div>
          <div class="k">Arrival</div>
          <div class="v">{{ f.arrivalTime | date:'short' }}</div>
        </div>
      </div>
    </div>

    <div class="flight-right">
      <div class="price">₹{{ f.price }}</div>
      <div class="seats">Seats: {{ f.availableSeats }}</div>
      <button class="btn-book" (click)="bookFlight(f)">Book Now</button>
    </div>
  </div>
</section>

<div class="state empty" *ngIf="searched && flights.length === 0">
  No flights found
</div>
